// --- INITIALIZATION (more robust for mobile) ---
window.addEventListener('load', () => {
    safeStartApp();
});

function safeStartApp() {
    const overlay = document.getElementById('loadingOverlay');
    const progressEl = document.getElementById('loadingProgress');

    // If for some reason elements aren't found, just show the main app
    if (!overlay || !progressEl) {
        console.warn('Loading elements not found, skipping loader.');
        try {
            initializeApp();
        } catch (e) {
            console.error(e);
        }
        return;
    }

    let progress = 0;
    const loadingInterval = setInterval(() => {
        progress += 10;
        progressEl.style.width = progress + '%';

        if (progress >= 100) {
            clearInterval(loadingInterval);
            setTimeout(() => {
                overlay.classList.add('hidden');
                try {
                    initializeApp();
                } catch (e) {
                    console.error('Error during initializeApp:', e);
                }
            }, 500);
        }
    }, 150);

    // ðŸ” Hard fallback: in case *anything* goes wrong, hide overlay after 8s
    setTimeout(() => {
        if (!overlay.classList.contains('hidden')) {
            console.warn('Forcing loader to hide (fallback).');
            overlay.classList.add('hidden');
        }
    }, 8000);
}
